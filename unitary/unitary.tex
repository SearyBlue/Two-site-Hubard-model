\documentclass[12pt]{report}
\usepackage{common}
\begin{document}
The goal is to obtain the unitary transformation. In the half-filled subspace for the Hubbard dimer,
\beq
\ham = \bordermatrix{~ & \ket{\ua,\da} & \ket{\ua\da,0} & \ket{\da,\ua} & \ket{0,\ua\da} \cr
	& 0 & t & 0 & -t \cr \\
	& t & U & -t & 0 \cr \\
	& 0 & -t & 0 & t\cr \\
	& -t & 0 & t & U \cr}
\eeq
I have dropped the part of the Hamiltonian involving \il{\ket{\ua,\ua}} and \il{\ket{\da,\da}} because they are already decoupled and do not change under the RG. Notice that \il{\ham} can be written as 
\beq
	\ham = \bordermatrix{~ & \ket{n_{1\ua} = 1} & \ket{n_{1\ua}=0} \cr
		& a & b \cr\\
		& b & a \cr}
\eeq
Applying RG on this matrix,
\begin{gather}
H_e = H_h = a \\
T = b\\
\eta^\dagger = \fr{1}{E - H_e}c^\dagger_{1\ua} T = \fr{1}{E - a}c^\dagger_{1\ua}b\\
\implies \eta  = b^\dagger c_{1\ua}\fr{1}{E - a}
\end{gather}
From properties of \il{\eta},
\begin{gather}
\hat n_{1\ua} = \eta^\dagger \eta = \fr{1}{E-a}c^\dagger_{1\ua}c_{1\ua}bb^\dagger\fr{1}{E-a} \\
\implies(E-a)^2 \hat n_{1\ua} = \hat n_{1\ua}b^2
\end{gather}
I used \il{b = -t\sigma_x \implies b^\dagger = b}. The two solutions for \il{E} are
\begin{gather}
E -a = \pm b \\
\implies E_\pm = a \pm b\\
\implies \ham_\text{rotated} = \bordermatrix{~ & \ket{n_{1\ua} = 1} & \ket{n_{1\ua}=0} \cr
		& a-b & 0 \cr
		& 0 & a+b \cr}
		=\begin{pmatrix}
		  0 & 2t & 0 & 0 \\
		  2t & U & 0 & 0 \\
		  0 & 0 & 0 & 0 \\
		  0 & 0 & 0 & U
	  \end{pmatrix}
\end{gather}
For this step, the unitary is
\beq
U_1 = \fr{1}{\sqrt 2} \bordermatrix{~ & \ket{n_{1\ua} = 1} & \ket{n_{1\ua}=0} \cr
				      & -1 & 1 \cr\\
				      & 1 & 1 \cr}
	= \fr{1}{\sqrt 2} \begin{pmatrix} \\ & -\mathbb{I}_{2\times 2} & \mathbb{I}_{2\times 2} &\\\\\\
	& \mathbb{I}_{2\times 2} & \mathbb{I}_{2\times 2} & \\
	&&&
	\end{pmatrix}
\eeq
Taking a look at \il{\ham_\text{rotated}}, the lower block is diagonal. So, take the upper block as the new Hamiltonian,
\begin{gather}
\ham = \bordermatrix{~ &  \ket{0,\da} & \ket{\da,0}\cr
	     & 0 & 2t \cr
	     & 2t & U \cr}\\
H_e = 0, H_h = U, T = 2t \\
\eta^\dagger = \fr{1}{E - H_e} c_{1\da}^\dagger T = \fr{2t}{E} c_{1\da}^\dagger \\
\eta = \fr{1}{E - H_h} T^\dagger c_{1\da} = \fr{2t}{E - U} c_{1\da}\\
\hat n_{1\da} = \eta^\dagger \eta = \fr{4t^2}{E(E-U)}\hat n_{1\da}\\
\implies E(E-U)=4t^2 \implies E = \fr{U\pm\Delta}{2}
\end{gather}
Therefore,
\begin{gather}
	\ham_{rotated} = \begin{pmatrix}\fr{U-\Delta}{2} & 0 \\ 0 & \fr{U+\Delta}{2} \end{pmatrix}\\
	\mathcal{U} = \begin{pmatrix} \fr{4t}{N_-} & \fr{4t}{N_+} \\ \fr{U-\Delta}{N_-} & \fr{U+\Delta}{N_+} \end{pmatrix}
	\end{gather}
\il{N_\pm^2 = \Delta\rr{\Delta\pm U}}. Since this unitary acts only on the upper block, the complete unitary for this stage is
\beq
		U_2 = \begin{pmatrix} \fr{\mathcal{U}}{\sqrt 2} & 0_{2\times 2} \\
		0_{2\times 2} & \mathbb{I}_{2\times 2}\end{pmatrix}
\eeq
The total unitary for the entire diagonalization process is
\beq
U = U_1 \times U_2 = \fr{1}{\sqrt 2}\begin{pmatrix}
	-\fr{\mathcal{U}}{\sqrt 2} & 1 \\
	\fr{\mathcal{U}}{\sqrt 2} & 1
	\end{pmatrix}
\eeq
To check whether these are correct, we can compute the eigenstates. The eigenstates of the unitarily rotated Hamiltonian are just the fermionic degrees of freedom \il{\ket{n_{i\sigma}}}. The eigenstates of the bare Hamiltonian are hence obtained by rotating these states:
\beq
			\overline {\ket{\psi_1}}=U\ket{\ua,\da} = \fr{1}{\sqrt 2}\begin{pmatrix} -\fr{\mathcal{U}}{\sqrt 2} & 1 \\& \\ 
				\fr{\mathcal{U}}{\sqrt 2} & 1 \end{pmatrix} \begin{bmatrix} 1 \\ 0 \\ 0 \\ 0 \end{bmatrix} &= \fr{1}{2 N_-}\begin{bmatrix} -4t \\ -U+\Delta \\ 4t \\ U-\Delta \end{bmatrix} \sim \fr{1}{N_-}\cc{2t\rr{\ket{\ua,\da} - \ket{\da,\ua}}+\fr{U-\Delta}{2}\rr{\ket{\ua\da,0}-\ket{0,\da\ua}}}\\
				\overline {\ket{\psi_2}}=U\ket{\ua,\da} &=  \fr{1}{2 N_+}\begin{bmatrix} -4t \\ -(U+\Delta) \\ 4t \\ U+\Delta \end{bmatrix} \sim \fr{1}{N_+}\cc{2t\rr{\ket{\ua,\da} - \ket{\da,\ua}}+\fr{U+\Delta}{2}\rr{\ket{\ua\da,0}-\ket{0,\da\ua}}} \\
				\overline {\ket{\psi_3}}=U\ket{\ua,\da} &=  \begin{bmatrix} 1 \\ 0 \\ 1 \\ 0 \end{bmatrix} \sim \fr{1}{\sqrt 2}\rr{\ket{\ua,\da} + \ket{\da,\ua}}\\
				\overline {\ket{\psi_4}}=U\ket{\ua,\da} &= \begin{bmatrix} 0 \\ 1 \\ 0 \\ 1 \end{bmatrix} \sim \fr{1}{\sqrt 2}\cc{\ket{\ua\da,0} + \ket{0,\ua\da}}
\eeq
Now that we have the unitary transformaiton, the contention is that the following is the correct effective Hamiltonian:
\beq
\overline \ham = U\hat n_{2\ua}\hat n_{2\da} + \fr{U-\Delta}{2}\hat n_{1\ua}\hat n_{2\da}+ \fr{U+\Delta}{2}\hat n_{1\ua}\hat n_{1\da}
\eeq
To check that this gives the correct eigenvalues, I operate this on the states which should be its eigenstates, that is, the decoupled degrees of freedom \il{\ket{n_{i\sigma}}}:
\beq
\ol \ham \ket{\ua,\da}&=\begin{pmatrix} \fr{U-\Delta}{2} & 0 & 0 & 0 \\ 0 & \fr{U+\Delta}{2} & 0 & 0 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & U \end{pmatrix}\begin{bmatrix} 1 \\ 0 \\ 0 \\ 0 \end{bmatrix} = \fr{U-\Delta}{2}\\
\ol \ham \ket{\ua\da,0}&=\begin{pmatrix} \fr{U-\Delta}{2} & 0 & 0 & 0 \\ 0 & \fr{U+\Delta}{2} & 0 & 0 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & U \end{pmatrix}\begin{bmatrix} 0 \\ 1 \\ 0 \\ 0 \end{bmatrix} = \fr{U+\Delta}{2}\\
\ol \ham \ket{\da,\ua}&=\begin{pmatrix} \fr{U-\Delta}{2} & 0 & 0 & 0 \\ 0 & \fr{U+\Delta}{2} & 0 & 0 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & U \end{pmatrix}\begin{bmatrix} 0 \\ 0 \\ 1 \\ 0 \end{bmatrix} = 0\\
\ol \ham \ket{0,\ua\da}&=\begin{pmatrix} \fr{U-\Delta}{2} & 0 & 0 & 0 \\ 0 & \fr{U+\Delta}{2} & 0 & 0 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & U \end{pmatrix}\begin{bmatrix} 0 \\ 0 \\ 0 \\ 1 \end{bmatrix} = U\\
\eeq
Next is a proof that \il{\ol \ham} is unitarily linked with the bare Hamiltonian by the same unitary transformation:
\beq
U \overline \ham U^T = \fr{1}{\sqrt 2}\begin{pmatrix} -\fr{\mathcal{U}}{\sqrt 2} & 1 \\
\fr{\mathcal{U}}{\sqrt 2} & 1 \end{pmatrix}
	\begin{pmatrix} \fr{U-\Delta}{2} & 0 & 0 & 0 \\ 0 & \fr{U+\Delta}{2} & 0 & 0 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & U \end{pmatrix}\begin{pmatrix} -\fr{\mathcal{U}^T}{\sqrt 2} & \fr{\mathcal{U}^T}{\sqrt 2} \\
	1 & 1 \end{pmatrix} = \begin{pmatrix}
	0 & t & 0 & -t  \\
	t & U & -t & 0  \\
	0 & -t & 0 & t \\
-t & 0 & t & U \end{pmatrix} = \ham
\eeq
This proves that \il{\overline \ham} shares the symmetries of \il{\ham}. To see the nature of the rotated spin-inversion operator,
\begin{gather}
T = S_1^x \otimes S_2^x =  \begin{pmatrix}
		   \sigma_x & 0 \\
		   0 & \sigma_x
		   \end{pmatrix}\\
		   \ol{T} = U T U^T = \fr{1}{2}\begin{pmatrix} -\fr{\mathcal{U}}{\sqrt 2} & 1 \\
		   \fr{\mathcal{U}}{\sqrt 2} & 1 \end{pmatrix}
		\begin{pmatrix}
		\sigma_x & 0 \\
		0 & \sigma_x
		\end{pmatrix}
			   \begin{pmatrix} -\fr{\mathcal{U}^T}{\sqrt 2} & \fr{\mathcal{U}^T}{\sqrt 2} \\
		1 & 1 
		\end{pmatrix}
		=\fr{1}{2}\begin{pmatrix}
			\fr{\mathcal{U}\sigma_x\mathcal{U}^T}{2}+\sigma_x &  -\fr{\mathcal{U}\sigma_x\mathcal{U}^T}{2}+\sigma_x\\
			-\fr{\mathcal{U}\sigma_x\mathcal{U}^T}{2} +\sigma_x & \fr{\mathcal{U}\sigma_x\mathcal{U}^T}{2} + \sigma_x		
	\end{pmatrix}
\end{gather}
Some calculation yields
\beq
				\fr{\mathcal{U}\sigma_x\mathcal{U}^T}{2} = \fr{1}{2N_+N_-}\begin{pmatrix} 32t^2 & 8Ut \\ 8Ut & -32t^2\end{pmatrix} = \fr{1}{\Delta}\rr{4t^2\sigma_z + U\sigma_x}
\eeq
So,
\beq
	\ol{T} = U T U^T &= \fr{1}{2\Delta}\begin{pmatrix} 4t^2\sigma_z + \rr{U+\Delta}\sigma_x & -4t^2\sigma_z - \rr{U-\Delta}\sigma_x\\ -4t^2\sigma_z - \rr{U-\Delta}\sigma_x& 4t^2\sigma_z + \rr{U+\Delta}\sigma_x \end{pmatrix}\\
			 &= \fr{1}{2}\rr{1+\fr{U}{\Delta}}T+\fr{2t^2}{\Delta}\sigma_z\otimes\mathbb{I}-\fr{1}{\Delta}\cc{2t^2\sigma_z+\fr{U-\Delta}{2}\sigma_x}\otimes\sigma_x
\eeq
\end{document}
